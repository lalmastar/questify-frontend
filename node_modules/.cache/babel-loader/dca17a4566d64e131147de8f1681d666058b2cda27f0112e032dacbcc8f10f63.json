{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/lalmastar/OneDrive/Desktop/Questify/questify-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"C:/Users/lalmastar/OneDrive/Desktop/Questify/questify-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/lalmastar/OneDrive/Desktop/Questify/questify-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/lalmastar/OneDrive/Desktop/Questify/questify-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useDispatch}from'react-redux';import{allQuestions}from'../features/asyncThunks/questions.thunk';import{pageQuery}from'../features/asyncThunks/queries.thunk';var useFetchHomeData=function useFetchHomeData(_ref){var pageNum=_ref.pageNum,questionAdded=_ref.questionAdded,answerAdded=_ref.answerAdded;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),pageData=_useState2[0],setPageData=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),totalPageData=_useState4[0],setTotalPageData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),questionsData=_useState6[0],setQuestionsData=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isloading=_useState8[0],setIsloading=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),hasmore=_useState10[0],setHasmore=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],setError=_useState12[1];var dispatch=useDispatch();useEffect(function(){setIsloading(true);function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _pgData$payload,_pgData$payload2,_pgData$payload2$ques,_pgData$payload3,_newData$payload,_pgData$payload5,_pgData$payload6;var pgData,_pgData$payload4,newData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(pageQuery({page:pageNum,limit:10}));case 2:pgData=_context.sent;setIsloading(false);if(!((_pgData$payload=pgData.payload)!==null&&_pgData$payload!==void 0&&_pgData$payload.error)&&(_pgData$payload2=pgData.payload)!==null&&_pgData$payload2!==void 0&&(_pgData$payload2$ques=_pgData$payload2.questions)!==null&&_pgData$payload2$ques!==void 0&&_pgData$payload2$ques.length){setPageData(function(prevData){var uniqueQuestions=pgData.payload.questions.filter(function(q){return!prevData.some(function(pq){return pq._id===q._id;});});return[].concat(_toConsumableArray(prevData),_toConsumableArray(uniqueQuestions));});setTotalPageData(pgData.payload.questionsCount);setHasmore(pgData.payload.questionsCount>pageData.length+5);}else if((_pgData$payload3=pgData.payload)!==null&&_pgData$payload3!==void 0&&_pgData$payload3.error){setError((_pgData$payload4=pgData.payload)===null||_pgData$payload4===void 0?void 0:_pgData$payload4.error);}_context.next=7;return dispatch(allQuestions({limit:10,page:1}));case 7:newData=_context.sent;if(!((_newData$payload=newData.payload)!==null&&_newData$payload!==void 0&&_newData$payload.error))setQuestionsData(newData.payload);else if((_pgData$payload5=pgData.payload)!==null&&_pgData$payload5!==void 0&&_pgData$payload5.error)setError((_pgData$payload6=pgData.payload)===null||_pgData$payload6===void 0?void 0:_pgData$payload6.error);case 9:case\"end\":return _context.stop();}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[pageNum]);return{isloading:isloading,hasmore:hasmore,pageData:pageData,totalPageData:totalPageData,questionsData:questionsData,error:error};};export default useFetchHomeData;","map":{"version":3,"names":["useState","useEffect","useDispatch","allQuestions","pageQuery","useFetchHomeData","_ref","pageNum","questionAdded","answerAdded","_useState","_useState2","_slicedToArray","pageData","setPageData","_useState3","_useState4","totalPageData","setTotalPageData","_useState5","_useState6","questionsData","setQuestionsData","_useState7","_useState8","isloading","setIsloading","_useState9","_useState10","hasmore","setHasmore","_useState11","_useState12","error","setError","dispatch","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_pgData$payload","_pgData$payload2","_pgData$payload2$ques","_pgData$payload3","_newData$payload","_pgData$payload5","_pgData$payload6","pgData","_pgData$payload4","newData","wrap","_callee$","_context","prev","next","page","limit","sent","payload","questions","length","prevData","uniqueQuestions","filter","q","some","pq","_id","concat","_toConsumableArray","questionsCount","stop"],"sources":["C:/Users/lalmastar/OneDrive/Desktop/Questify/questify-frontend/src/hooks/useFetchHomeData.hooks.jsx"],"sourcesContent":["import { useState,useEffect } from 'react'\r\nimport { useDispatch } from 'react-redux';\r\nimport { allQuestions } from '../features/asyncThunks/questions.thunk';\r\nimport { pageQuery } from '../features/asyncThunks/queries.thunk';\r\n\r\nconst useFetchHomeData = ({pageNum,questionAdded,answerAdded}) => {\r\n    const [pageData, setPageData] = useState([]);\r\n    const [totalPageData, setTotalPageData] = useState(0);\r\n    const [questionsData, setQuestionsData] = useState([]);\r\n    const [isloading, setIsloading] = useState(true);\r\n    const [hasmore,setHasmore] = useState(false);\r\n    const [error, setError] = useState(null);\r\n\r\n    const dispatch=useDispatch()\r\n\r\n    useEffect(()=>{\r\n        setIsloading(true);\r\n        async function fetchData() {\r\n          const pgData = await dispatch(pageQuery({ page: pageNum, limit: 10 }));\r\n          setIsloading(false);\r\n          if((!pgData.payload?.error) && pgData.payload?.questions?.length ){\r\n            setPageData(prevData => {\r\n              const uniqueQuestions = pgData.payload.questions.filter(q => !prevData.some(pq => pq._id === q._id));\r\n              return [...prevData, ...uniqueQuestions];\r\n            });\r\n            setTotalPageData(pgData.payload.questionsCount);\r\n            setHasmore((pgData.payload.questionsCount>(pageData.length+5)))\r\n          }else if(pgData.payload?.error){\r\n            setError(pgData.payload?.error)\r\n          }\r\n          const newData = await dispatch(allQuestions({ limit: 10, page: 1 }));\r\n          if(!newData.payload?.error)\r\n            setQuestionsData(newData.payload);\r\n          else if(pgData.payload?.error)\r\n              setError(pgData.payload?.error)\r\n        }\r\n        fetchData();\r\n    },[pageNum])\r\n  \r\n    return {isloading,hasmore,pageData,totalPageData,questionsData,error}\r\n}\r\n\r\nexport default useFetchHomeData"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}